---

- name: post license key
  uri:
    url: "{{ tower_local_api_url }}/config/"
    method: POST
    user: "{{ tower_username }}"
    password: "{{ tower_password }}"
    body: "{{ tower_license }}"
    body_format: json
    validate_certs: False
    force_basic_auth: yes
  ignore_errors: True
  when: tower_license is defined
  run_once: yes

- block:
    - include_tasks: remove_demo.yml
  rescue:
    - include_tasks: remove_demo_api.yml